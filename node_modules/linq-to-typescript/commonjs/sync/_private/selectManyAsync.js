"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.selectManyAsync = void 0;
const fromAsync_1 = require("../../async/static/fromAsync");
const selectManyAsync = (source, selector) => {
    if (selector.length === 1) {
        return selectManyAsync1(source, selector);
    }
    else {
        return selectManyAsync2(source, selector);
    }
};
exports.selectManyAsync = selectManyAsync;
const selectManyAsync1 = (source, selector) => {
    async function* generator() {
        for (const value of source) {
            const innerValues = await selector(value);
            for (const innerValue of innerValues) {
                yield innerValue;
            }
        }
    }
    return (0, fromAsync_1.fromAsync)(generator);
};
const selectManyAsync2 = (source, selector) => {
    async function* generator() {
        let index = 0;
        for (const value of source) {
            const innerValues = await selector(value, index);
            for (const innerValue of innerValues) {
                yield innerValue;
            }
            index++;
        }
    }
    return (0, fromAsync_1.fromAsync)(generator);
};
